## Описание

Даны таблицы:
- `Accounts` Лицевые счета (иерархическая таблица). Лицевой счет ссылается на квартиру, квартира на дом. В квартире/доме может быть несколько лицевых счетов. Так же лицевой счёт может быть привязан к дому.
- `Counters` Счетчики
- `Meter_Pok` Показания счетчиков
  - В таблице хранятся показаний счетчика за расчетный месяц. Показание в месяце может отсутствовать. Возможно существование двух и более показаний по счетчику. В этом случае суммарное потребление это сумма расходов всех показаний за месяц.
  - Тариф используется для учета потребления в определенный момент дня (день/ночь - для 2-х тарифного) или (пик, полупик, ночь - для 3-х тарифного). Суммарным расходом по лицевому за месяц будет сумма расхода по всем тарифам счетчика.
  - Поле дата хранит в себе дату показаний (необходимо для определения последнего показания, при наличии 2 и более показаний в один месяце).

В тексте заданий используется диалект _PostgreSQL_.

## Задание №1

Написать функцию [select_count_pok_by_service](https://github.com/Danspers/STEK-test/blob/main/database/select_count_pok_by_service.sql). Она получает строкой номера услуг и дату, а возвращает количество показаний по услуге для каждого лицевого счёта. Результатом вызова функции должна быть таблица с 3 колонками:
- `acc` (Лицевой счет)
- `service` (Услуга)
- `count` (Количество показаний)

Примеры вызова функции:
```SQL
SELECT * FROM stack.select_count_pok_by_service(300,'20230201');

-- acc|service|count
-- 111	 300     1
-- 122   300     1
-- 144	 300     1
-- 211	 300     2
-- 222	 300     2
-- 233	 300     1
-- 244	 300     1
-- 255	 300     3
-- 266	 300     3
-- 277	 300     2
-- 288	 300     3
-- 301	 300     1
```

## Задание №2

Написать функцию [select_value_by_house_and_month](https://github.com/Danspers/STEK-test/blob/main/database/select_value_by_house_and_month.sql). Она получает номер дома и месяц. Возвращает все лицевые счета в этом доме. Для счетов выводятся все счетчики с суммарным расходом за месяц (суммируя все показания тарифов). Результатом вызова функции должна быть таблица с 3 колонками:

- `acc` (Лицевой счет)
- `name` (Наименование счетчика)
- `value` (Расход)

Примеры вызова функции:
```SQL
SELECT * FROM stack.select_value_by_house_and_month(1,'20230201');

-- acc|          name           |value
-- 111	Счетчик на воду           150
-- 111	Счетчик на отопление      -50
-- 111	Счетчик на электричество   80
-- 122	Счетчик на воду           105
-- 122	Счетчик на отопление        0
-- 133	Счетчик на воду           900
-- 133	Счетчик на отопление       -1
-- 144	Счетчик на воду             0
-- 144	Счетчик на отопление       10
-- 144	Счетчик на электричество  100
```

## Задание №3
Написать функцию [select_last_pok_by_acc](https://github.com/Danspers/STEK-test/blob/main/database/select_last_pok_by_acc.sql). Она получает номер лицевого счёта. Возвращает дату, тариф и значение последнего показания по каждой услуге. Результатом вызова функции должна быть таблица с 5 колонками:

- `acc` (Лицевой счет)
- `service` (Услуга)
- `date` (Дата показания)
- `tarif` (Тариф показания)
- `value` (Объем)

Примеры вызова функции:
```SQL
SELECT * FROM stack.select_last_pok_by_acc(144);

-- acc|service|   date   |tarif|value|
-- 144	 100   2023-02-21   1      0
-- 144	 200   2023-02-27   1      0
-- 144	 300   2023-02-28   1    100
-- 144	 400   2023-02-26   1     10
```

```SQL
SELECT * FROM stack.select_last_pok_by_acc(266);

-- acc|service|   date   |tarif|value|
-- 266	 300	 2023-02-27   1    -90
-- 266	 300	 2023-02-27   2      0
-- 266	 300	 2023-02-27   3     13
```
